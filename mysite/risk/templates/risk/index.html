{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <title>Risk Calculation System</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'risk/style.css' %}" />
  </head>
  <body>
    <div class="sidenav">
      <a href="/risk/stock/">Stock</a>
      <a href="/risk/portfolio/">Portfolio</a>
      <a href="/risk/option/">Option</a>
    </div>

    <div class="main">
      {% if version == "stock" %}
      <div class="risk-title">Stock</div>
      <div class="risk-subtitle">Stock VaR and ES Calculation...</div>
      <div class="risk-data">
        {% if stockForm %}
        <form action="/risk/stock/" method="post">
          {% csrf_token %}
          <table class='risk-table'>
            {{ stockForm }}
          </table>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        {% endif %}
      </div>
      {% endif %}
      
      {% if version == "portfolio" %}
      <div class="risk-title">Portfolio</div>
      <div class="risk-subtitle">Portfolio VaR and ES Calculation...</div>
      <div class="risk-data">
        {% if portfolioForm %}
        <form action="/risk/portfolio/" method="post">
          {% csrf_token %}
          <table class='risk-table'>
            {{ portfolioForm }}
          </table>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        {% endif %}
      </div>
      {% endif %}

      {% if version == "option" %}
      <div class="risk-title">Option</div>
      <div class="risk-subtitle">Option VaR and ES Calculation...</div>
      <div class="risk-data">
        {% if optionForm %}
        <form action="/risk/option/" method="post">
          {% csrf_token %}
          <table class='risk-table'>
            {{ optionForm }}
          </table>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        {% endif %}
      </div>
      {% endif %}
      <div id="plot"></div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript">
      {% if plotValue %}
        var plotData = jQuery.parseJSON('{{ plotValue|safe }}');
        var data = [
          {
            x: plotData['x'],
            y: plotData['y'],
            type: 'scatter',
            name: 'price'
          }
        ];
        var layout = {
          title: plotData['ticker']+" Price Chart",
          xaxis: {
            title: 'Date',
            rangeslider: {}
          },
          yaxis: {
            title: 'Price'
          },
          showlegend: true
        }
        Plotly.newPlot('plot', data, layout);
        $('#plot').show()
      {% endif %}
    </script>
  </body>
</html>